//!wrt $BSPEC:{"icn":"apps/effects","cpr":"Copyright (C) Windows 96 Team 2023.","dsc":"Desktop Effects","frn":"Effects","ver":1,"ssy":"gui"}

const{WindowParams:WindowParams}=w96,{Theme:Theme,MessageBox:MessageBox}=w96.ui,{setEnv:setEnv}=w96.sys.env;function _clsAdd_mgfx(e){document.querySelector("#maingfx").classList.add(e)}function _clsRemove_mgfx(e){document.querySelector("#maingfx").classList.remove(e)}function _clsAdd_body(e){document.querySelector("body").classList.add(e)}function _clsRemove_body(e){document.querySelector("body").classList.remove(e)}const fxMap={hue:{start:function(){_clsAdd_body("fx-hue")},stop:function(){_clsRemove_body("fx-hue")}},spinner:{start:function(){_clsAdd_body("fx-spin")},stop:function(){_clsRemove_body("fx-spin")}},"upside-down":{start:function(){_clsAdd_body("fx-upside-down")},stop:function(){_clsRemove_body("fx-upside-down")}},zoom:{start:function(){_clsAdd_body("fx-zoom")},stop:function(){_clsRemove_body("fx-zoom")}},deepfryer:{start:function(){_clsAdd_body("fx-deepfryer")},stop:function(){_clsRemove_body("fx-deepfryer")}},grayscale:{start:function(){_clsAdd_body("fx-grayscale")},stop:function(){_clsRemove_body("fx-grayscale")}},invert:{start:function(){_clsAdd_body("fx-invert")},stop:function(){_clsRemove_body("fx-invert")}},blur:{start:function(){_clsAdd_body("fx-blur")},stop:function(){_clsRemove_body("fx-blur")}},disco:{start:function(){var e=document.querySelector(".fx-desk-overlay");e||((e=document.createElement("div")).classList.add("fx-desk-overlay","fx-hue"),document.querySelector(".user-desktop").appendChild(e))},stop:function(){var e=document.querySelector(".fx-desk-overlay");e&&e.remove()}},neon:{start:function(){var e=document.querySelector(".fx-neon-css");e||((e=document.createElement("style")).classList.add("fx-neon-css"),document.body.appendChild(e)),e.innerHTML="\n            .window-dlg:not(.ui-sortable-helper) {\n                box-shadow: 0 0 12px 6px #c725d4 !important;\n            }\n            \n            .start-menu {\n                box-shadow: 0px 0px 20px 4px lime !important;\n            }\n            \n            .wcontext-menu {\n                box-shadow: 0 0 11px 0px cyan !important;\n            }"},stop:function(){var e=document.querySelector(".fx-neon-css");e&&e.remove()}},sepia:{start:function(){_clsAdd_body("fx-sepia")},stop:function(){_clsRemove_body("fx-sepia")}},bright:{start:function(){_clsAdd_body("fx-bright")},stop:function(){_clsRemove_body("fx-bright")}},bw:{start:function(){_clsAdd_body("fx-bw")},stop:function(){_clsRemove_body("fx-bw")}}};class FXApplication extends WApplication{constructor(){super()}async main(e){super.main(e),this._createWindow(),this.fxQueue=[],setEnv("fxQueue",this.fxQueue)}getFxNames(){var e="";return Object.keys(fxMap).sort((function(e,t){return e>t?1:e<t?-1:0})).forEach((t=>{e+='<option name="'+t+'">'+t+"</option>\n"})),e}_resetFx(){this.fxQueue.forEach((e=>{fxMap[e].stop()})),this.fxQueue=[]}async _createWindow(){this.appDlg=new MessageBox("Effects",`Select an effect below:<br><br>\n<select class="w96-select" style="width: 100%">\n    ${this.getFxNames()}\n</select>`,"../apps/effects","OK",(()=>{})),this.appDlg.dlg.registerAppBar(),this.appDlg.dlg.setWindowIcon(await Theme.getIconUrl("apps/effects","16x16"));const e=this.appDlg.dlg.wndObject.querySelector(".buttons");e.innerHTML='<button class="w96-button btnappend">Append</button>\n        <button class="w96-button btnapply">Apply</button>\n        <button class="w96-button btnreset">Reset</button>';const t=this.appDlg.dlg.wndObject.querySelector("select"),n=e.querySelector(".btnapply"),o=e.querySelector(".btnreset"),s=e.querySelector(".btnappend");n.onclick=()=>{this._resetFx(),this.fxQueue=[t.value],setEnv("fxQueue",this.fxQueue),fxMap[t.value].start()},o.onclick=()=>{this._resetFx()},s.onclick=()=>{this.fxQueue.includes(t.value)||(this.fxQueue.push(t.value),setEnv("fxQueue",this.fxQueue),fxMap[t.value].start())},this.appDlg.setSize(320,130),this.appDlg.show(),this.appDlg.dlg.center()}}

return await WApplication.execAsync(new FXApplication(), this.boxedEnv.args, this);